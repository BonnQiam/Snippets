#Snippet of [[Git]]

# 撤销上次提交

- 如果被重置的提交只存在于本地，应该只使用 `reset`。此命令会更改提交历史记录，并且可能会覆盖远程团队成员所依赖的历史记录
- `revert` 则是是创建一个新的提交来撤消更改，因此如果要恢复的提交已经被推送到共享仓库，最好使用 `revert`，因为它不会覆盖提交历史

## revert 命令

revert 命令将创建一个提交，该提交还原所针对的提交的更改。你可以使用它来恢复最后一次提交，如下所示：

```shell
git revert <commit to revert>
```
可以使用 `git log` 找到要还原的提交的名称。那里描述的第一个提交是创建的最后一个提交。然后你可以从那里复制字母数字名称，并在 `revert` 命令中使用它。

![](http://127.0.0.1:80/uploads/Snipaste_2023-03-16_16-24-30.png)

## reset 命令

你还可以使用 `reset` 命令撤消上次提交。但要小心 —— 它会改变提交历史，所以你应该很少使用它。它会将 HEAD（工作分支）移动到指定的提交，并在之后丢弃任何内容：
```shell
git reset --soft HEAD~1
```
`--soft` 选项意味着你不会丢失可能有的未提交更改。

![](http://127.0.0.1:80/uploads/Snipaste_2023-03-16_16-24-47.png)

如果要重置为最后一次提交，并删除所有未暂存的更改，可以使用 `--hard` 选项：
```shell
git reset --hard HEAD~1
```
这将撤消最新的提交，但也会撤消任何未提交的更改。

![](http://127.0.0.1:80/uploads/Snipaste_2023-03-16_16-25-26.png)

PS. `HEAD^` 的意思是上一个版本，也可以写成 `HEAD~1`。如果你进行了 2 次 commit，想都撤回，可以使用 `HEAD~2`

### 参数介绍

- `--mixed` ：不删除工作空间改动代码，撤销 commit，并且撤销 `git add .` 操作这个为默认参数，`git reset --mixed HEAD^` 和 `git reset HEAD^` 效果是一样的。
- `--soft` :  不删除工作空间改动代码，撤销 commit，不撤销 `git add .` 
- `--hard` : 删除工作空间改动代码，撤销 commit，撤销 `git add .`。 注意完成这个操作后，就恢复到了上一次的 commit 状态。